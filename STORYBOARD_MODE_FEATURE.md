# 分镜生成模式功能

## 功能概述

在分镜配置中新增了两种生成模式选择：**普通模式** 和 **Remix模式**。

## 模式说明

### 普通模式 (Normal Mode)
- **默认模式**：每个分镜独立生成视频
- **支持参考图**：可以上传多张参考图来指导视频生成
- **适用场景**：需要精确控制每个分镜的视觉风格和内容

### Remix模式 (Remix Mode)
- **连续生成**：基于上一个已完成的分镜视频生成后续内容
- **不支持参考图**：为了保持视频连贯性，该模式不支持上传参考图
- **适用场景**：需要生成连贯的视频序列，确保前后分镜的视觉一致性

## 使用方法

1. 点击分镜卡片上的"配置"按钮
2. 在弹出的配置窗口右侧，选择"生成模式"
3. 根据需求选择"普通模式"或"Remix模式"
4. 配置其他参数（脚本、角色、参考图等）
5. 点击"保存"

## 技术实现

### 前端变更
- `Storyboard` 类型新增 `mode` 字段：`'normal' | 'remix'`
- `StoryboardSettingsModal` 组件新增模式选择器
- Remix模式下自动禁用参考图上传功能
- 切换到Remix模式时自动清空已上传的参考图

### 后端变更
- Prisma Schema 中 `Storyboard` 模型新增 `mode` 字段，默认值为 `'normal'`
- API 路由支持 `mode` 字段的创建和更新
- Remix API 移除了参考图参数支持

### 生成逻辑
- **普通模式**：调用 `/api/videos/storyboard-to-video` 接口，支持参考图
- **Remix模式**：
  - 如果有上一个已完成的分镜，调用 `/api/videos/remix/:taskId` 接口
  - 如果没有上一个已完成的分镜，降级为普通模式生成

## 注意事项

1. Remix模式需要上一个分镜已经生成完成才能使用
2. 切换到Remix模式会自动清空已上传的参考图
3. 数据库迁移已完成，现有分镜默认为普通模式
